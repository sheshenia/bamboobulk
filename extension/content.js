(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const o of n)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function a(n){const o={};return n.integrity&&(o.integrity=n.integrity),n.referrerPolicy&&(o.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?o.credentials="include":n.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function c(n){if(n.ep)return;n.ep=!0;const o=a(n);fetch(n.href,o)}})();let i,r,l,u;const b=()=>i&&r&&l,w=e=>i.hasOwnProperty(e),C=e=>{var t,a;return!!((a=(t=i[e])==null?void 0:t.clockEntries)!=null&&a.length)},T=e=>new Date(e).getDate()<=u,O=()=>{const e=/CSRF_TOKEN\s*=\s*"([^"]+)"/im,t=document.scripts;for(let a=0;a<t.length;a++){const c=t[a].text;if(!c)continue;const n=c.match(e);if(n!=null&&n.length)return n[1]}},S=()=>{var a,c;const e=document.getElementById("js-timesheet-data");if(!e)return;const t=JSON.parse(e.textContent);console.log(t),i=(a=t==null?void 0:t.timesheet)==null?void 0:a.dailyDetails,r=t==null?void 0:t.employeeId,l=O(),console.log("CSRF_TOKEN: ",l),u=new Date(((c=t==null?void 0:t.today)==null?void 0:c.date)??Date.now()).getDate(),console.log(u)},g={id:null,note:"",projectId:null,taskId:null},B=[{...g,trackingId:1,start:"09:00",end:"13:00"},{...g,trackingId:2,start:"14:00",end:"18:00"}],d="clockEntries",h=async()=>{const e=await chrome.storage.local.get(d);return window.__DEBUG__&&console.log("Value currently is: ",e==null?void 0:e[d]),e!=null&&e[d]?(window.__DEBUG__&&console.log("Founded in storage:",e[d]),e[d]):(window.__DEBUG__&&console.log("Not founded clockEntries in local extension storage"),null)},E=(e,t,a)=>e.map((c,n)=>{let{start:o,end:s}=c;return o==="24:00"&&(o="00:00"),s==="00:00"&&(s="24:00"),{id:null,trackingId:n+1,employeeId:a,date:t,start:o,end:s,note:"",projectId:null,taskId:null}}),k=(e,t)=>B.map(a=>({...a,employeeId:t,date:e})),D="https://ninjaone.bamboohr.com/timesheet/clock/entries",_=async(e,t)=>{await fetch(D,{method:"POST",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Csrf-Token":e},body:JSON.stringify({entries:t})})},N=async(e,t)=>{await fetch(D,{method:"DELETE",credentials:"same-origin",headers:{"Content-Type":"application/json","X-Csrf-Token":e},body:JSON.stringify({entries:t})})},I=e=>new Promise(t=>setTimeout(t,e)),y=e=>e<10?"0"+e:e,x=e=>{const t=document.createElement("div");return t.className="one_day_del_btn",t.title="Delete clock entries",t.textContent="❌",t.onclick=async a=>{var n,o;a.stopPropagation();const c=(o=(n=i[e])==null?void 0:n.clockEntries)==null?void 0:o.map(s=>s.id);c!=null&&c.length&&(await N(l,c),location.reload())},t},P=async e=>{console.log("Add:",e);const t=await h(),a=t!=null&&t.length?E(t,e,r):k(e,r);await _(l,a),location.reload()},L=e=>{const t=document.createElement("div");return t.className="one_day_add_btn",t.title="Add clock entries",t.textContent="🕔",t.onclick=()=>P(e),t},j=()=>{document.querySelectorAll(".TimesheetSlat").forEach(e=>{const t=e.querySelector(".TimesheetSlat__dayDate");if(t)try{const a=new Date().getFullYear(),c=new Date(t.textContent+" "+a),n=`${a}-${y(c.getMonth()+1)}-${y(c.getDate())}`;w(n)&&T(n)&&(console.log("adding delBtn to:",t.textContent,"dateData:",n),e.appendChild(C(n)?x(n):L(n)))}catch(a){console.log(a)}})},v=async()=>{var a,c,n;if(!b())return;const e=document.getElementById("bamboobulk_btn");e.disabled=!0,e.textContent="Processing...";const t=await h();console.log("storageEntries:",t);for(const o of Object.values(i)){if(!o.date||(a=o==null?void 0:o.holidays)!=null&&a.length||(c=o==null?void 0:o.timeOff)!=null&&c.length)continue;const s=new Date(o.date),m=s.getDay();if(s.getDate()>u||m===6||m===0||(n=o==null?void 0:o.clockEntries)!=null&&n.length)continue;const f=t!=null&&t.length?E(t,o.date,r):k(o.date,r);console.log(f),await _(l,f),await I(500),console.log(o.date)}location.reload()},F=()=>{const e=document.createElement("button");return e.type="button",e.id="bamboobulk_btn",e.className="bamboobulk_btn",e.textContent="Bulk Time Entries",e.addEventListener("click",v),e},A=()=>{const e=document.createElement("div");return e.id="bamboo-bulk-btn-container",e.className="bamboo-bulk-btn-container",e.appendChild(F()),e},p=document.querySelector(".TimesheetSummaryContainer");p&&(S(),b()&&(p.prepend(A()),j()));
